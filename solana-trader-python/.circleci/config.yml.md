# config.yml

The `config.yml` file is a configuration file for CircleCI, a continuous integration and delivery platform. It defines a pipeline with jobs that are run in specified environments. Here's a breakdown of what each part does:

* `version: 2.1`: This line specifies the version of CircleCI to use.
* `executors:`: This section defines an executor named `bxpython`. Executors define the environment in which the jobs will be run. In this case, the executor uses a Docker image with Python 3.10.7, sets two environment variables (`RUN_TRADES` and `RUN_SLOW_STREAMS`), and sets the working directory to `~/ws`.
* `jobs:`: This section defines several jobs (`init`, `lint`, `unit`, `mainnet_examples`). Jobs are collections of steps that are run in the executor environment. Each job has a series of steps that include checking out the code, restoring cache, installing dependencies, saving cache, and running specific tasks like linting, testing, or running examples.
  * `init:`
    * `attach_workspace:`: This step attaches the workspace at `~/ws`.
    * `checkout:`: This step checks out the code from the repository into the `solana-trader-client-python` directory.
    * `restore_cache:`: This step restores a cache that is identified by a key. The key is generated by hashing the contents of the `requirements.txt` file.
    * `run:`: These steps run commands in the executor environment. The first `run` step installs `awscli`, and the second `run` step installs the Python dependencies listed in `requirements.txt` and runs the `make environment-integration` command.
    * `save_cache:`: This step saves a cache that is identified by a key. The key is generated by hashing the contents of the `requirements.txt` file. The cache includes the Python virtual environment.
    * `persist_to_workspace:`: This step persists the workspace so that it can be used in subsequent jobs.
  * `lint:`attaches the workspace, activates the Python virtual environment, and runs the `make lint` command to perform linting on the code.
    * `executor: bxpython`: This line specifies that the job should be run in the `bxpython` executor. Executors define the environment in which the jobs will be run.
      * `steps:`: This section defines the steps that are run as part of the job.
        * `attach_workspace:`: This step attaches the workspace at `~/ws`. The workspace is a data store that is shared between jobs in a workflow.
        * `run:`: This step runs a command in the executor environment. In this case, it changes the current directory to `~/ws/solana-trader-client-python`, activates the Python virtual environment, and runs the `make lint` command.
  * `unit:`attaches the workspace, activates the Python virtual environment, and runs the `make test` command to perform unit testing on the code.
    * `executor: bxpython`: This line specifies that the job should be run in the `bxpython` executor. Executors define the environment in which the jobs will be run.
      * `steps:`: This section defines the steps that are run as part of the job.
      * `attach_workspace:`: This step attaches the workspace at `~/ws`. The workspace is a data store that is shared between jobs in a workflow.
      * `run:`: This step runs a command in the executor environment. In this case, it changes the current directory to `~/ws/solana-trader-client-python`, activates the Python virtual environment, and runs the `make test` command.
* `mainnet_examples:`: attaches the workspace, exports the commit details, and runs an example script in the mainnet environment.
  * `executor: bxpython`: This line specifies that the job should be run in the `bxpython` executor. Executors define the environment in which the jobs will be run.
  * `steps:`: This section defines the steps that are run as part of the job.
    * `attach_workspace:`: This step attaches the workspace at `~/ws`. The workspace is a data store that is shared between jobs in a workflow.
    * `run:`: These steps run commands in the executor environment. The first `run` step exports the commit hash and author to the environment. The second `run` step unsets the `PRIVATE_KEY` environment variable, activates the Python virtual environment, and runs the `main.py` script in the `example/provider` directory with `API_ENV` set to `mainnet` and `AUTH_HEADER` set to the value of `AUTH_HEADER_MAINNET`.
* `workflows:`: This section defines two workflows (`test-branch` and `nightly`). Workflows are a set of rules for defining a collection of jobs and their run order. The `test-branch` workflow runs the `init`, `lint`, and `unit` jobs for non-scheduled pipelines, while the `nightly` workflow runs the `init` and `unit` jobs for scheduled pipelines.
